<VirtualHost *:80>
	ServerAdmin webmaster@localhost
	ServerName sources.debian.net
	ServerAlias sources tytso.irill.org sources.upsilon.cc

	DocumentRoot /srv/www/debsources/public_html
	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>
	<Directory /srv/www/debsources/public_html>
		Options Indexes FollowSymLinks MultiViews
		AllowOverride None
		Order allow,deny
		allow from all
	</Directory>

	<Directory /srv/www/debsources/public_html/data>
		Options Indexes
		AllowOverride None
		DirectoryIndex disabled
		IndexOptions +ShowForbidden
		# Note: mods-enabled/autoindex.conf has IndexIgnore set to
		# ignore all hidden files by default. For IndexOptions to be
		# practically useful, that entry should be commented out (or
		# reset'd with IndexOptionsReset, but only starting from Apache
		# 2.3).

		<Files ~ "^\.ht">
		       # override default (Debian) setting in /etc/apache2/apache2.conf
		       Allow from all
		</Files>
	</Directory>

	RewriteEngine on
	# RewriteMap src2data txt:/srv/debsources/sources.map
	RewriteMap src2data dbm:/srv/debsources/sources.dbm
	RewriteRule ^/src/([^/]+/[^/]+)/(.*) /data/${src2data:$1}/$2

	#<DirectoryMatch "^/srv/www/debsources/public_html/data/.*/.*/.*/$">
	#	<FilesMatch "\.(log|done)$">
	#		Order deny,allow
	#		deny from all
	#	</FilesMatch>
	#</DirectoryMatch>

	#ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
	#<Directory "/usr/lib/cgi-bin">
	#	AllowOverride None
	#	Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
	#	Order allow,deny
	#	Allow from all
	#</Directory>

	ErrorLog ${APACHE_LOG_DIR}/debsources-error.log
	LogLevel warn
	CustomLog ${APACHE_LOG_DIR}/debsources-access.log combined
</VirtualHost>
