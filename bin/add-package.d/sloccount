#!/bin/bash

source "/srv/debsources/etc/config.sh"
source "${bindir}/lib.sh"

destdir="$1"
package="$2"
version="$3"
if [ -z "$destdir" -o -z "$package" -o -z "$version" ] ; then
    err "Usage: sloccount DESTDIR PACKAGE VERSION" 3
fi

sloccount "$destdir" &> "${destdir}.sloccount"

rc=$?
if [ "$rc" -ne 0 ] && ! grep -q '^SLOC total is zero,' "${destdir}.sloccount" ; then
    warn "sloccount returned exit code ${rc} on ${package}/${version}"
fi

exit 0
