#    -*- mode: org -*-


Archived entries from file /srv/debian/debsources.bugs/BUGS


* DONE [1/1] stats about disk usage over time 		    :web:infra:stats:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-05 Fri 17:08
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
** DONE publish size graphs on the web


* DONE http://codemirror.net/ (suggestion by Paul Tagliamonte)
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-06 sab 11:59
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_OLPATH: [1/1] alternative syntax highlighting toolkits
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :ARCHIVE_ITAGS: web hilight
  :END:
  not really suitable, in standalone mode it doesn't offer line numbering nor
  auto detection, so there isn't much to gain wrt highlight.js

* DONE get rid of left menu					 :web:layout:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-08 lun 15:32
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  it consumes too much horizontal space on small screens

  reported by: Helmut Grohne on #debian-qa


* DONE https							 :infra:conf:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-10 Wed 11:07
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  https://sources.debian.net should do the right thing, instead of redirecting
  to (a broken version of) irill.org


* TODO replace etc/webconfig.py with a Python ini-like conffile	   :web:conf:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-10 Wed 11:12
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: TODO
  :END:
  Rationale: a Python module is dangerous and the only fancy functionality we
  need is interpolation, which is supported by ConfigParser. The relative
  import trick used by app.config.from_pyfile can be used for ConfigParser
  instead.


* DONE Git commit notifications to #debian-qa			    :dev:irc:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-11 Thu 16:28
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:

* TODO better language detection using shebang lines		:web:hilight:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-15 Mon 11:05
  :ARCHIVE_FILE: ~/work/debian/debsources_bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: TODO
  :END:
  as suggested in the LWN thread at https://lwn.net/Articles/557371/
** see Geany approach and code
   http://sources.debian.net/src/geany/1.22%2Bdfsg-2/src/filetypes.c#L887

* DONE "search code" should search in current package			:web:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-17 Wed 16:22
  :ARCHIVE_FILE: ~/work/debian/debsources_bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  when applicable, i.e. for all URLs below http://sources.d.n/src/FOO , once
  the source package context has been determined. To avoid UI confusion, the
  code search box should likely be pre-populated with "package:FOO", so that
  users are informed that the search is different there and can override it to
  search all sources. Feature suggested by Michael Stapelberg on #debian-qa. As
  a reference, see PTS search box.

* DONE improve extension<->language mapping			:web:hilight:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-17 Wed 18:52
  :ARCHIVE_FILE: ~/work/debian/debsources_bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  reusing the one of Geany as suggested in https://lwn.net/Articles/557712/ .
  See
  http://sources.debian.net/src/geany/1.22%2Bdfsg-2/data/filetype_extensions.conf





* DONE push update						      :infra:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-07-19 Fri 08:55
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  - best option in terms of bandwidth is ftp.de.d.o
  - need to figure out how to ssh into the machine (via the jumphost) w/o
    having a dedicated INRIA account
* TODO get rid of Flask-SQLAlchemy plugin 		     :web:sqlalchemy:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-08-08 Thu 17:29
  :ARCHIVE_FILE: ~/work/debian/debsources_bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: TODO
  :END:
  "raw" SQLAlchemy is better



* DONE de-duplicate configuration web/infra			  :infra:web:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-08-11 Sun 16:30
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  requirement: feature/db-ng branch

  Starting from that feature the infrastructure should use etc/config.ini
  (INI-style file, parsed by ConfigParser) as its main configuration entry.
  The web app should use that file for all configuration information that is
  storable in a INI-style file, and rely to webconfig.py only for all *other*
  information, e.g. the stuff that should be native Python (and which also
  changes way less often) such as the language regexes. Among the stuff that is
  representable in INI-like files, it would make sense to have the Web-only
  stuff under a separate [web] seciton in the INI file.


* TODO [0/0] alternative syntax highlighting toolkits		:web:hilight:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-08-11 Sun 16:31
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: TODO
  :END:

* DONE link to package VCS					  :web:links:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-08-12 lun 10:01
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  On Wed, Jun 19, 2013 at 05:13:18PM +0200, Martin Quinson wrote:
  > It would be good to have a link to the VCS somewhere on the interface. I
  > know I can find it through the PTS, but that could be more straightforward,
  > maybe.
  Issue here: good balance between functionalities and redoing stuff already
  done elsewhere, and in particular in the PTS.
  Idea: maybe we can exploit the forthcoming PTS REST interface and load this
  kind of info AJAX-ly?


* DONE shutil.rmtree error during gc				      :infra:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-09-05 Thu 22:31
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
    2013-08-17 15:38:43 update-debsources:ERROR failed to remove ghc/7.6.3-2
    Traceback (most recent call last):
      File "/srv/debsources/bin/update-debsources", line 225, in garbage_collect
        fs_storage.remove_package(pkg, pkgdir)
      File "/home/srv/debsources/python/fs_storage.py", line 47, in remove_package
        shutil.rmtree(destdir)
      File "/usr/lib/python2.7/shutil.py", line 247, in rmtree
        rmtree(fullname, ignore_errors, onerror)
      File "/usr/lib/python2.7/shutil.py", line 247, in rmtree
        rmtree(fullname, ignore_errors, onerror)
      File "/usr/lib/python2.7/shutil.py", line 247, in rmtree
        rmtree(fullname, ignore_errors, onerror)
      File "/usr/lib/python2.7/shutil.py", line 241, in rmtree
        fullname = os.path.join(path, name)
      File "/usr/lib/python2.7/posixpath.py", line 80, in join
        path += '/' + b
    UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 7: ordinal not in range(128)

  more generally:
  $ grep 'ERROR failed to remove' /var/log/debsources/debsources.log

  notes:
  - the one above has been removed by hand, to test that the debsources user
    can in fact in the abstract do a successful shutil.rmtree (so it's
    something more contextual, reproducible only during an actual upgrade)
  - upon failed removal, the ctime of the dir gets updated (likely because
    /some/ files are actually removed successfully). As a consequence, another
    removal is attempted only another expire period later

** note: should have been fixed by ccface6304cdff3b9e84a0a00a4792f96236bdaa
   to be verified...

* DONE merge web/models.py and web/flask/models_app.py			:web:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-10-16 Wed 17:40
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  since we don't use sqlalchemy plugin anymore, methods from
  *_app can be merged into * (* = Package, Version, ...)

* DONE [#A] suite support					      :infra:
  :PROPERTIES:
  :ARCHIVE_TIME: 2013-12-23 Mon 14:24
  :ARCHIVE_FILE: /srv/debian/debsources.bugs/BUGS
  :ARCHIVE_CATEGORY: BUGS
  :ARCHIVE_TODO: DONE
  :END:
  to be able to compute statistics on a per-release basis

